{% extends 'cv/base.html' %}

{% block content %}
    <div class="text-center mb-5">
        <h2 class="fw-bold text-success"><i class="bi bi-briefcase-fill"></i> Experiencia Laboral</h2>
        <p class="text-muted">Mi trayectoria profesional y los roles que he desempeñado.</p>
    </div>

    <div class="row g-3 dynamic-grid"> 
        {% for exp in experiencia %}
        
        <div class="col-lg-6 d-flex align-items-stretch">
            <div class="card border-0 shadow-sm rounded-4 w-100 hover-card overflow-hidden">
                
                <div class="card-body p-3">
                    
                    <div class="d-flex align-items-start">
                        <div class="d-flex align-items-center justify-content-center bg-light rounded-circle text-success flex-shrink-0" 
                             style="width: 45px; height: 45px;">
                            <i class="bi bi-building-fill fs-5"></i>
                        </div>
                        
                        <div class="ms-3 flex-grow-1">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h5 class="fw-bold text-dark mb-0 fs-6">{{ exp.cargo }}</h5>
                                    <small class="text-muted fw-normal d-block mt-1">
                                        <i class="bi bi-shop me-1"></i> {{ exp.empresa }}
                                    </small>
                                </div>
                                
                                {% if not exp.fecha_fin %}
                                    <span class="badge bg-success-subtle text-success rounded-pill border border-success px-2 py-1" style="font-size: 0.7rem;">
                                        Actual
                                    </span>
                                {% else %}
                                    <span class="badge bg-light text-secondary rounded-pill border px-2 py-1" style="font-size: 0.7rem;">
                                        Finalizado
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="mt-3 ms-1 ps-3 border-start border-3 border-success text-secondary small">
                        {{ exp.descripcion }}
                    </div>

                </div>

                <div class="card-footer bg-white border-top-0 pt-0 pb-3 px-3">
                    <div class="d-flex justify-content-between align-items-center text-muted small bg-light rounded-3 px-3 py-2">
                        <span>
                            <i class="bi bi-calendar-event me-1 text-success"></i> {{ exp.fecha_inicio }}
                        </span>
                        <i class="bi bi-arrow-right text-secondary small opacity-50"></i>
                        <span>
                            <i class="bi bi-calendar-check me-1 text-success"></i> 
                            {% if exp.fecha_fin %}{{ exp.fecha_fin }}{% else %}Presente{% endif %}
                        </span>
                    </div>
                </div>

                <div class="progress" style="height: 3px;">
                    <div class="progress-bar {% if not exp.fecha_fin %}bg-success{% else %}bg-secondary{% endif %}" role="progressbar" style="width: 100%"></div>
                </div>
            </div>
        </div>

        {% empty %}
        <div class="col-12 text-center py-5">
            <div class="bg-light rounded-circle d-inline-flex p-4 mb-3 text-muted">
                <i class="bi bi-person-workspace fs-1"></i>
            </div>
            <p class="text-muted fw-medium">Aún no se ha registrado experiencia laboral.</p>
        </div>
        {% endfor %}
    </div>

    <style>
        /* Animación suave al pasar el mouse */
        .hover-card {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .hover-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.08) !important;
        }
        
        /* Ajuste de fuente en móviles */
        .card-footer .small {
            font-size: 0.85rem;
        }

        /* --- LÓGICA DE GRID INTELIGENTE --- */
        /* Solo aplica en pantallas grandes (Escritorio) */
        @media (min-width: 992px) {
            /* Selecciona el elemento que sea:
               1. Hijo directo de dynamic-grid
               2. El ÚLTIMO hijo (:last-child)
               3. Y que sea IMPAR (:nth-child(odd)) -> 1, 3, 5...
            */
            .dynamic-grid > .col-lg-6:last-child:nth-child(odd) {
                width: 100%;
                max-width: 100%;
                flex: 0 0 100%;
            }
        }
    </style>
{% endblock %}